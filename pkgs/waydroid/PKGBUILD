# Maintainer: Danct12 <danct12@disroot.org>
# Contributor: Bart Ribbers <bribbers@disroot.org>

pkgname=waydroid
pkgver=1.4.2
pkgrel=1
pkgdesc="A container-based approach to boot a full Android system on a regular Linux system"
arch=('any')
url='https://waydro.id/'
_url='https://github.com/waydroid/waydroid'
license=('GPL')
depends=('lxc' 'python-gbinder' 'python-gobject' 'nftables' 'dnsmasq' 'gtk3' 'dbus-python')
makedepends=('git')
optdepends=('python-pyclip: share clipboard with container')
source=("${pkgname}-${pkgver}.tar.gz::${_url}/archive/refs/tags/${pkgver}.tar.gz"
        "add-shutdown-action.patch")
sha512sums=('0d3eba799895c853545b7087e3c07160d593d4a3166822039973669bc0ee93a8a6b9c394a7d982e57cfbbfbd8df1ba7991dd33b1b1517d79fcbe191d8a86890a'
            '81b5bb64122c1670f9533998219821e778702d3cec15915719e872de3811ede4714485b509269d695f016c76f3783dbe6a60d45a0d10df0c19cb67fa61d08c4f')

prepare() {
  cd "$pkgname-$pkgver"
  patch -p1 < "$srcdir/add-shutdown-action.patch"
}
package() {
  make -C "${pkgname}-${pkgver}" install DESTDIR="$pkgdir" USE_NFTABLES=1
}
